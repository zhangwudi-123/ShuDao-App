{"ast":null,"code":"var _jsxFileName = \"D:\\\\project\\\\vsCode\\\\baicaho\\\\bc-app\\\\src\\\\pages\\\\PackRecord\\\\index.js\";\nimport React, { useEffect, useMemo, useRef, useState, useCallback } from 'react';\nimport { Page, Navbar, NavLeft, NavTitle, PageContent, Button, BlockTitle, Card } from '@hvisions/f-ui';\nimport moment from 'moment';\nimport { session, tree } from '@hvisions/toolkit';\nimport { isEmpty, debounce } from 'lodash';\nimport { onToast, createDialog } from '~/util/home';\nimport PackService from '~/api/packRecord';\nimport styles from './style.scss';\nimport backIcon from '~/pages/WarehousinManage/img/backIcon.png';\n\nconst PackRecord = _ref => {\n  let {\n    f7router,\n    ...props\n  } = _ref;\n  const [records, setRecords] = useState([]);\n  const [pageInfo, setPageInfo] = useState({\n    page: 0,\n    pageSize: 10\n  });\n  const [allowInfinite, setAllowInfinite] = useState(true);\n  const [totalElements, setTotalElements] = useState(0);\n  const [showPreloader, setShowPreloader] = useState(false);\n\n  const loadData = pageInfo => {\n    f7router.app.preloader.show();\n    PackService.getProductByQuery({ ...pageInfo,\n      state: [3]\n    }).then(res => {\n      setRecords(res.content);\n      setTotalElements(res.totalElements);\n    }).catch(err => {\n      onToast(err.message, styles.toastError);\n    }).finally(() => {\n      f7router.app.preloader.hide();\n      setShowPreloader(false);\n      setAllowInfinite(true);\n    });\n  };\n\n  const loadMore = () => {\n    if (!allowInfinite) return;\n    setShowPreloader(true);\n    console.log('again');\n\n    if (pageInfo.pageSize >= totalElements) {\n      setShowPreloader(false);\n      return;\n    }\n\n    setAllowInfinite(false);\n    const newPageInfo = { ...pageInfo,\n      pageSize: pageInfo.pageSize + 10\n    };\n    setPageInfo(newPageInfo);\n    loadData(newPageInfo);\n  };\n\n  useEffect(() => {\n    loadData({\n      page: 0,\n      pageSize: 10\n    });\n  }, []);\n\n  const renderCard = () => {\n    return records.map((item, index) => {\n      return /*#__PURE__*/React.createElement(Card, {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: styles['card-ul'],\n        onClick: () => {\n          f7router.navigate('/yw-pack-record-detail', {\n            props: {\n              itemData: item\n            }\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: styles['li-title'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 15\n        }\n      }, '工单编号:' + (item.workOrderCode || ''))), /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: styles['li-next-title'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 15\n        }\n      }, \"\\u4EA7\\u54C1\\u7F16\\u7801\"), /*#__PURE__*/React.createElement(\"span\", {\n        className: styles['li-next-title'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 15\n        }\n      }, item.materialCode || '')), /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: styles['li-next-title'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 15\n        }\n      }, \"\\u4EA7\\u54C1\\u540D\\u79F0\"), /*#__PURE__*/React.createElement(\"span\", {\n        className: styles['li-next-title'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 15\n        }\n      }, item.materialName || ''))));\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Page, {\n    pageContent: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(NavLeft, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    onClick: () => f7router.back(),\n    className: \"ne-navleft\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"\",\n    style: {\n      height: 24\n    },\n    src: backIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(NavTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, \"\\u6536\\u6599\\u8BB0\\u5F55\")), /*#__PURE__*/React.createElement(PageContent, {\n    infinite: true,\n    infiniteDistance: 50,\n    infinitePreloader: showPreloader,\n    onInfinite: loadMore,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }\n  }, renderCard()));\n};\n\nexport default PackRecord;","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","useCallback","Page","Navbar","NavLeft","NavTitle","PageContent","Button","BlockTitle","Card","moment","session","tree","isEmpty","debounce","onToast","createDialog","PackService","styles","backIcon","PackRecord","f7router","props","records","setRecords","pageInfo","setPageInfo","page","pageSize","allowInfinite","setAllowInfinite","totalElements","setTotalElements","showPreloader","setShowPreloader","loadData","app","preloader","show","getProductByQuery","state","then","res","content","catch","err","message","toastError","finally","hide","loadMore","console","log","newPageInfo","renderCard","map","item","index","navigate","itemData","workOrderCode","materialCode","materialName","back","height"],"sources":["D:/project/vsCode/baicaho/bc-app/src/pages/PackRecord/index.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState, useCallback } from 'react';\r\nimport {\r\n  Page,\r\n  Navbar,\r\n  NavLeft,\r\n  NavTitle,\r\n  PageContent,\r\n  Button,\r\n  BlockTitle,\r\n  Card\r\n} from '@hvisions/f-ui';\r\nimport moment from 'moment';\r\nimport { session, tree } from '@hvisions/toolkit';\r\nimport { isEmpty, debounce } from 'lodash';\r\nimport { onToast, createDialog } from '~/util/home';\r\nimport PackService from '~/api/packRecord';\r\nimport styles from './style.scss';\r\n\r\nimport backIcon from '~/pages/WarehousinManage/img/backIcon.png';\r\nconst PackRecord = ({ f7router, ...props }) => {\r\n  const [records, setRecords] = useState([]);\r\n  const [pageInfo, setPageInfo] = useState({ page: 0, pageSize: 10 });\r\n  const [allowInfinite, setAllowInfinite] = useState(true);\r\n  const [totalElements, setTotalElements] = useState(0);\r\n  const [showPreloader, setShowPreloader] = useState(false);\r\n  const loadData = pageInfo => {\r\n    f7router.app.preloader.show();\r\n    PackService.getProductByQuery({ ...pageInfo, state: [3] })\r\n      .then(res => {\r\n        setRecords(res.content);\r\n        setTotalElements(res.totalElements);\r\n      })\r\n      .catch(err => {\r\n        onToast(err.message, styles.toastError);\r\n      })\r\n      .finally(() => {\r\n        f7router.app.preloader.hide();\r\n        setShowPreloader(false);\r\n        setAllowInfinite(true);\r\n      });\r\n  };\r\n\r\n  const loadMore = () => {\r\n    if (!allowInfinite) return;\r\n    setShowPreloader(true);\r\n    console.log('again');\r\n    if (pageInfo.pageSize >= totalElements) {\r\n      setShowPreloader(false);\r\n      return;\r\n    }\r\n    setAllowInfinite(false);\r\n    const newPageInfo = { ...pageInfo, pageSize: pageInfo.pageSize + 10 };\r\n    setPageInfo(newPageInfo);\r\n    loadData(newPageInfo);\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadData({ page: 0, pageSize: 10 });\r\n  }, []);\r\n  const renderCard = () => {\r\n    return records.map((item, index) => {\r\n      return (\r\n        <Card key={index}>\r\n          <ul\r\n            className={styles['card-ul']}\r\n            onClick={() => {\r\n              f7router.navigate('/yw-pack-record-detail', { props: { itemData: item } });\r\n            }}\r\n          >\r\n            <li>\r\n              <span className={styles['li-title']}>{'工单编号:' + (item.workOrderCode || '')}</span>\r\n            </li>\r\n            <li>\r\n              <span className={styles['li-next-title']}>产品编码</span>\r\n              <span className={styles['li-next-title']}>{item.materialCode || ''}</span>\r\n            </li>\r\n            <li>\r\n              <span className={styles['li-next-title']}>产品名称</span>\r\n              <span className={styles['li-next-title']}>{item.materialName || ''}</span>\r\n            </li>\r\n          </ul>\r\n        </Card>\r\n      );\r\n    });\r\n  };\r\n  return (\r\n    <Page pageContent={false}>\r\n      <Navbar>\r\n        <NavLeft>\r\n          <a onClick={() => f7router.back()} className=\"ne-navleft\">\r\n            <img alt=\"\" style={{ height: 24 }} src={backIcon} />\r\n          </a>\r\n        </NavLeft>\r\n        <NavTitle>收料记录</NavTitle>\r\n      </Navbar>\r\n      <PageContent\r\n        infinite\r\n        infiniteDistance={50}\r\n        infinitePreloader={showPreloader}\r\n        onInfinite={loadMore}\r\n      >\r\n        {renderCard()}\r\n      </PageContent>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default PackRecord;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}