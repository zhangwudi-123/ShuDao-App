{"ast":null,"code":"var _jsxFileName = \"D:\\\\project\\\\vsCode\\\\baicaho\\\\bc-app\\\\src\\\\pages\\\\WarehousinManage\\\\Stocktakin\\\\TopInfo.js\";\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { Page, Navbar, PageContent, NavLeft, NavTitle, Toggle, Card, CardContent } from '@hvisions/f-ui';\nimport { CircularProgressbarWithChildren, buildStyles } from 'react-circular-progressbar';\nimport PropTypes from 'prop-types';\nimport { isEmpty } from 'lodash';\nimport 'react-circular-progressbar/dist/styles.css';\nimport backIcon from '../img/backIcon.png';\nimport searchIcon from '../img/searchIcon.png';\nimport checkIcon from '../img/checkIcon.png';\nimport styles from './style.scss';\nimport { onToast, createDialog } from '~/util/home';\nimport CardInfo from './CardInfo';\nimport stockService from '~/api/stocktakin';\n\nconst TopInfo = _ref => {\n  let {\n    $f7,\n    f7router,\n    setLoading,\n    loading,\n    getLockState,\n    setStockStatus,\n    stockStatus\n  } = _ref;\n\n  // useEffect(() => {\n  //     getLockState()\n  // }, [])\n  // const getLockState = () => {\n  //     stockService\n  //       .getLockState()\n  //       .then(res => {\n  //           if (res) {\n  //             setStockStatus(true);\n  //           } else {\n  //             setStockStatus(false);\n  //           }\n  //       })\n  //       .catch(err => {\n  //         onToast(err.message, styles.toastError)\n  //       });\n  // };\n  const openLockState = async () => {\n    setLoading(true);\n    await stockService.lockStock().then(res => {\n      setStockStatus(true);\n      onToast('锁库成功', styles.toastSuccess);\n    }).catch(err => {\n      onToast(err.message, styles.toastError);\n    });\n    setLoading(false);\n  };\n\n  const unLockStock = () => {\n    stockService.unLockStock().then(res => {\n      setStockStatus(false);\n      onToast('关闭成功', styles.toastSuccess);\n    }).catch(err => {\n      onToast(err.message, styles.toastError);\n    });\n  };\n\n  const handleOpen = () => {\n    createDialog('确认锁库?', '盘点锁库，开启后，锁住库存。盘点审核结束后请关闭盘点锁库。', async () => {\n      try {\n        await openLockState();\n      } catch (error) {\n        onToast('锁库失败', styles.toastError);\n      }\n    });\n  };\n\n  const handleChangeStatus = e => {\n    if (e) {\n      unLockStock();\n    } else {\n      handleOpen();\n    }\n  };\n\n  const goDetail = () => {\n    if (stockStatus == 1) {\n      f7router.navigate('/stocktakinDetail');\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles['operate'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles['operate-lock'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles['operate-seitch'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles['operate-title'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 21\n    }\n  }, \"\\u9501\\u5E93\\u76D8\\u70B9\"), /*#__PURE__*/React.createElement(Toggle, {\n    checked: stockStatus,\n    onToggleChange: e => handleChangeStatus(e),\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles['operate-text'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, \"\\u8BF7\\u5148\\u9501\\u5E93\\u518D\\u8FDB\\u884C\\u76D8\\u70B9\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: stockStatus == 0 ? styles['operate-inventory'] : styles['operate-inventory-handle'],\n    onClick: goDetail,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: checkIcon,\n    alt: \"check\",\n    width: \"32\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles['inventory-text'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  }, \"\\u5F00\\u59CB\\u76D8\\u70B9\")));\n};\n\nexport default TopInfo;","map":{"version":3,"names":["React","useEffect","useMemo","useState","Page","Navbar","PageContent","NavLeft","NavTitle","Toggle","Card","CardContent","CircularProgressbarWithChildren","buildStyles","PropTypes","isEmpty","backIcon","searchIcon","checkIcon","styles","onToast","createDialog","CardInfo","stockService","TopInfo","$f7","f7router","setLoading","loading","getLockState","setStockStatus","stockStatus","openLockState","lockStock","then","res","toastSuccess","catch","err","message","toastError","unLockStock","handleOpen","error","handleChangeStatus","e","goDetail","navigate"],"sources":["D:/project/vsCode/baicaho/bc-app/src/pages/WarehousinManage/Stocktakin/TopInfo.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { \r\n    Page, \r\n    Navbar, \r\n    PageContent,\r\n    NavLeft, \r\n    NavTitle, \r\n    Toggle,\r\n    Card,\r\n    CardContent\r\n} from '@hvisions/f-ui';\r\nimport { CircularProgressbarWithChildren, buildStyles } from 'react-circular-progressbar';\r\nimport PropTypes from 'prop-types';\r\nimport { isEmpty } from 'lodash';\r\nimport 'react-circular-progressbar/dist/styles.css';\r\nimport backIcon from '../img/backIcon.png'\r\nimport searchIcon from '../img/searchIcon.png'\r\nimport checkIcon from '../img/checkIcon.png'\r\nimport styles from './style.scss';\r\nimport { onToast, createDialog } from '~/util/home';\r\nimport CardInfo from './CardInfo';\r\nimport stockService from '~/api/stocktakin';\r\n\r\n\r\nconst TopInfo = ({ $f7, f7router, setLoading, loading, getLockState, setStockStatus, stockStatus}) => {\r\n    \r\n\r\n    // useEffect(() => {\r\n    //     getLockState()\r\n    // }, [])\r\n \r\n   \r\n    // const getLockState = () => {\r\n    //     stockService\r\n    //       .getLockState()\r\n    //       .then(res => {\r\n    //           if (res) {\r\n    //             setStockStatus(true);\r\n    //           } else {\r\n    //             setStockStatus(false);\r\n    //           }\r\n    //       })\r\n    //       .catch(err => {\r\n    //         onToast(err.message, styles.toastError)\r\n    //       });\r\n    // };\r\n    const openLockState = async () => {\r\n        setLoading(true)\r\n        await stockService\r\n          .lockStock()\r\n          .then(res => {\r\n            setStockStatus(true);\r\n            onToast('锁库成功', styles.toastSuccess)\r\n          })\r\n          .catch(err => {\r\n            onToast(err.message, styles.toastError)\r\n          });\r\n          setLoading(false)\r\n      };\r\n      const unLockStock = () => {\r\n        stockService\r\n          .unLockStock()\r\n          .then(res => {\r\n            setStockStatus(false);\r\n            onToast('关闭成功', styles.toastSuccess)\r\n          })\r\n          .catch(err => {\r\n            onToast(err.message, styles.toastError)\r\n          });\r\n      };\r\n    const handleOpen = () => {\r\n        createDialog('确认锁库?', '盘点锁库，开启后，锁住库存。盘点审核结束后请关闭盘点锁库。', async () => {\r\n            try {\r\n                await openLockState()\r\n            } catch (error) {\r\n                onToast('锁库失败', styles.toastError);\r\n            }\r\n        });\r\n    }\r\n    const handleChangeStatus = (e) => {\r\n        if (e) {\r\n            unLockStock()\r\n        } else {\r\n            handleOpen()\r\n        }\r\n    }\r\n    const goDetail = () => {\r\n        if (stockStatus == 1) {\r\n            f7router.navigate('/stocktakinDetail');\r\n        }\r\n    }\r\n      \r\n    return (\r\n        \r\n        <div className={styles['operate']}>\r\n            <div className={styles['operate-lock']}>\r\n                <div className={styles['operate-seitch']}>\r\n                    <span className={styles['operate-title']}>锁库盘点</span>\r\n                    <Toggle \r\n                        checked={stockStatus}\r\n                        onToggleChange={e => handleChangeStatus(e)}\r\n                        disabled={loading}\r\n                    ></Toggle>\r\n                </div>\r\n                <p className={styles['operate-text']}>请先锁库再进行盘点</p>\r\n            </div>\r\n            <div className={stockStatus == 0 ? styles['operate-inventory'] : styles['operate-inventory-handle']} onClick={goDetail}>\r\n                <img src={checkIcon} alt=\"check\" width=\"32\"/>\r\n                <span className={styles['inventory-text']}>开始盘点</span>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default TopInfo"],"mappings":"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"},"metadata":{},"sourceType":"module"}